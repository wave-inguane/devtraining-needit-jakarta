<?xml version="1.0" encoding="UTF-8"?>
<record_update sys_domain="global" table="sys_script_client">
    <sys_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_extended>false</applies_extended>
        <condition/>
        <description/>
        <field>active</field>
        <global>true</global>
        <messages/>
        <name>UnitTESTbuffer</name>
        <order/>
        <script><![CDATA[function onLoad() {
   //Type appropriate comment here, and begin script below
	myAlert();
}


function myAlert(){
  g_form.addInfoMessage('<div class="modal-dialog modal-lg">'+
  '<div class="modal-content">'+
  '<div class="modal-header">'+
  '<h4 class="modal-title">Source Code</h4>'+
  '</div>'+
  '<div class="modal-body">'+
  '<pre>' +'UserName : '+ g_user.userName +'</pre>'+
  '</div>'+
  '</div>'+
  '</div>');
}


// setting to active = false to simplify how the dependencies can work.

function onChange(control, oldValue, newValue, isLoading) {
   if (isLoading || newValue == '') {
      return;
   }

   // this script is primarily used to set the task dependancy variables choices based on the task count
	
	if (newValue == '1'){
		g_form.setVisible('wo_task_1_dependency', false);	
	}
	
	if (newValue == '2'){
		g_form.setVisible('wo_task_1_dependency', false);		
		removeOptions('wo_task_1_dependency');
		addOptions('wo_task_1_dependency', newValue);		
		removeOptions('wo_task_2_dependency');
		addOptions('wo_task_2_dependency', newValue);
		
	}
	
	if (newValue == '3'){
		g_form.setVisible('wo_task_1_dependency', false);
		removeOptions('wo_task_1_dependency');
		addOptions('wo_task_1_dependency', newValue);		
		removeOptions('wo_task_2_dependency');
		addOptions('wo_task_2_dependency', newValue);
		removeOptions('wo_task_3_dependency');
		addOptions('wo_task_3_dependency', newValue);
	}
	
	if (newValue == '4'){
		g_form.setVisible('wo_task_1_dependency', false);
		removeOptions('wo_task_1_dependency');
		addOptions('wo_task_1_dependency', newValue);		
		removeOptions('wo_task_2_dependency');
		addOptions('wo_task_2_dependency', newValue);
		removeOptions('wo_task_3_dependency');
		addOptions('wo_task_3_dependency', newValue);
		removeOptions('wo_task_4_dependency');
		addOptions('wo_task_4_dependency', newValue);
	}
	
	if (newValue == '5'){
		g_form.setVisible('wo_task_1_dependency', false);
		removeOptions('wo_task_1_dependency');
		addOptions('wo_task_1_dependency', newValue);		
		removeOptions('wo_task_2_dependency');
		addOptions('wo_task_2_dependency', newValue);
		removeOptions('wo_task_3_dependency');
		addOptions('wo_task_3_dependency', newValue);
		removeOptions('wo_task_4_dependency');
		addOptions('wo_task_4_dependency', newValue);
		removeOptions('wo_task_5_dependency');
		addOptions('wo_task_5_dependency', newValue);
	}

	
	function addOptions(dependency, count){
		var depend = dependency.charAt(8);
		var stop = count++;
		for (var i = 1; i <= stop; i++){
			var h = i + '';
			if (depend != h){
				var task = 'Task ' + i;
				g_form.addOption(dependency, i, task);
			}
		}
	}
		
	function removeOptions(dependency){
		g_form.removeOption(dependency, '1');
		g_form.removeOption(dependency, '2');
		g_form.removeOption(dependency, '3');
		g_form.removeOption(dependency, '4');
		g_form.removeOption(dependency, '5');
	}
	   
}

//DEFAULT
function highlights(tableName,fieldName){
	//Highlight affected fields
	g_form.flash(tableName+'.'+fieldName, "#00FF00", -4);
	(function () {
		var myVar2 = g_form.getControl(fieldName);
		myVar2.style.width = '200px';
		myVar2.style.backgroundColor = 'yellow';
		myVar2.style.color = 'mediumblue';
		//myVar2.style.fontWeight = 'bold';
		(function (node) {
			var level = 1;
			var step = function () {
				var hex = level.toString(16);
				node.style.backgroundColor = '#FFFF' + hex + hex;
				if (level < 15) {
					level += 1;
					setTimeout(step, 100);
				}
			};
			setTimeout(step, 100);
		}(myVar2));
	}());
}

//--------------------------------------------------------------------------
/*
Hi Ian,

I am working on USCIS-1573, and I just hit a roadblock. I would like to share my screen with you today to demo the story and get some feedback from you.

I have attached a file that contains the breakdown of the story in 4-parts.

I am currently working on part one.

Please ping me on skype when you are ready to help out.
*/
//--------------------------------------------------------------------------


//--------------------------------------------------------------------------
// isMember check for membership
//--------------------------------------------------------------------------
function onLoad() {
	g_form.setValue('requested_by',g_user.userID);
	
	
	//Check to see if logged in user is a member of selected group
	var grpName = 'Deployment Services';
	var usrID = g_user.userID; //Get current user ID
	var grp = new GlideRecord('sys_user_grmember');
	grp.addQuery('group.name', grpName);
	grp.addQuery('user.sys_id', usrID);
	grp.query();
	if (grp.next()){
		// user is a member of the group - allow the form to load normally.
	}
	else {
		// user it not a member of the so we need to warn them that it won't work properly
		alert('This service is for Deployment Services group members only.  If you see this message the system does not recognize you as are being a member.  This will result in an inappropriate Catalog Task assignment.');
		g_form.showErrorBox("requested_by", "Not recognized as a Deployment Services group member"); 
	}	
}


//--------------------------------------------------------------------------
//--------------------------------------------------------------------------


//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------



//--------------------------------------------------------------------------
//--------------------------------------------------------------------------
]]></script>
        <sys_class_name>sys_script_client</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2017-10-16 04:59:17</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>674aac9a4f7983003b564ea18110c7f4</sys_id>
        <sys_mod_count>12</sys_mod_count>
        <sys_name>UnitTESTbuffer</sys_name>
        <sys_overrides/>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_script_client_674aac9a4f7983003b564ea18110c7f4</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2017-11-16 16:47:40</sys_updated_on>
        <table>x_58872_needit_needit</table>
        <type>onLoad</type>
        <ui_type>0</ui_type>
        <view/>
    </sys_script_client>
</record_update>
